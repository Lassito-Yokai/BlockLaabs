{% extends "base.html" %}
{% block title %}Document importé avec succès - RawDocs{% endblock %}

{% block content %}
<section class="card">
  <div class="success-header">
    <div class="success-badge">
      <i class="fas fa-check-circle success-icon"></i>
      <h2>Document importé avec succès !</h2>
    </div>
    <p class="success-description">
      Votre document PDF a été téléchargé et analysé. Vous pouvez maintenant le consulter et voir ses métadonnées.
    </p>
  </div>

  <!-- Visualisation du PDF -->
  <div class="document-section">
    <h3><i class="fas fa-file-pdf"></i> Aperçu du document</h3>
    <div class="pdf-container">
      <object data="{{ doc.file.url }}" type="application/pdf"
              width="100%" height="600">
        <div class="pdf-fallback">
          <i class="fas fa-file-pdf"></i>
          <p>Votre navigateur ne supporte pas l'affichage PDF.</p>
          <a href="{{ doc.file.url }}" class="btn" target="_blank">
            <i class="fas fa-download"></i>
            Télécharger le PDF
          </a>
        </div>
      </object>
    </div>
  </div>

  <!-- Métadonnées -->
  <div class="metadata-section">
    <h3><i class="fas fa-info-circle"></i> Métadonnées extraites</h3>
    <div class="metadata-container">
      <table class="metadata-table">
        <tbody>
          <tr>
            <th><i class="fas fa-heading"></i> Titre</th>
            <td>{{ metadata.title|default:"Non spécifié" }}</td>
          </tr>
          <tr>
            <th><i class="fas fa-calendar-alt"></i> Date</th>
            <td>{{ metadata.date|default:"Non spécifiée" }}</td>
          </tr>
          <tr>
            <th><i class="fas fa-language"></i> Langue</th>
            <td>
              {% if metadata.language %}
                <span class="language-badge">{{ metadata.language }}</span>
              {% else %}
                Non spécifiée
              {% endif %}
            </td>
          </tr>
          <tr>
            <th><i class="fas fa-globe"></i> Pays</th>
            <td>{{ metadata.country|default:"Non spécifié" }}</td>
          </tr>
          <tr>
            <th><i class="fas fa-external-link-alt"></i> Source</th>
            <td>
              {% if metadata.source %}
                <a href="{{ metadata.source }}" target="_blank" class="source-link">
                  <i class="fas fa-link"></i>
                  {{ metadata.source|truncatechars:50 }}
                </a>
              {% else %}
                Non spécifiée
              {% endif %}
            </td>
          </tr>
          <tr>
            <th><i class="fas fa-code-branch"></i> Version</th>
            <td>{{ metadata.version|default:"Non spécifiée" }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Actions -->
  <div class="actions-section">
    <a href="{% url 'rawdocs:upload' %}" class="btn-outline">
      <i class="fas fa-plus"></i>
      Importer un autre PDF
    </a>
    <a href="{{ doc.file.url }}" class="btn" target="_blank">
      <i class="fas fa-external-link-alt"></i>
      Ouvrir dans un nouvel onglet
    </a>
  </div>
</section>

<style>
.success-header {
  text-align: center;
  margin-bottom: 2.5rem;
  padding-bottom: 2rem;
  border-bottom: 1px solid var(--border-color);
}

.success-badge {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1rem;
  margin-bottom: 1rem;
}

.success-badge h2 {
  margin: 0;
  color: var(--success-color);
}

.success-description {
  color: var(--text-secondary);
  font-size: 1.1rem;
  max-width: 600px;
  margin: 0 auto;
  line-height: 1.6;
}

.document-section,
.metadata-section {
  margin-bottom: 2.5rem;
}

.document-section h3,
.metadata-section h3 {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  color: var(--text-primary);
  margin-bottom: 1.5rem;
  font-size: 1.25rem;
}

.pdf-fallback {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 1rem;
  padding: 3rem;
  text-align: center;
  background: #f8fafc;
}

.pdf-fallback i {
  font-size: 3rem;
  color: var(--text-secondary);
}

.metadata-container {
  background: #f8fafc;
  border-radius: 8px;
  padding: 1rem;
  border: 1px solid var(--border-color);
}

.metadata-table {
  margin: 0;
  box-shadow: none;
  border: none;
}

.metadata-table th {
  background: transparent;
  font-weight: 600;
  color: var(--text-primary);
  border: none;
  border-bottom: 1px solid var(--border-color);
  width: 25%;
}

.metadata-table td {
  border: none;
  border-bottom: 1px solid var(--border-color);
  color: var(--text-primary);
}

.metadata-table tr:last-child th,
.metadata-table tr:last-child td {
  border-bottom: none;
}

.metadata-table th i {
  margin-right: 0.5rem;
  color: var(--primary-color);
  width: 16px;
}

.language-badge {
  display: inline-flex;
  align-items: center;
  padding: 0.25rem 0.75rem;
  background: var(--primary-color);
  color: white;
  border-radius: 12px;
  font-size: 0.875rem;
  font-weight: 500;
}

.source-link {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  color: var(--primary-color);
  text-decoration: none;
  font-weight: 500;
}

.source-link:hover {
  text-decoration: underline;
}

.actions-section {
  display: flex;
  gap: 1rem;
  justify-content: center;
  padding-top: 1.5rem;
  border-top: 1px solid var(--border-color);
}

@media (max-width: 768px) {
  .actions-section {
    flex-direction: column;
  }

  .metadata-table th {
    width: 35%;
  }

  .success-badge {
    gap: 0.5rem;
  }

  .success-badge h2 {
    font-size: 1.5rem;
  }

  .pdf-fallback {
    padding: 2rem 1rem;
  }
}
</style>
{% endblock %}